import socket
import subprocess
import sys
from time import time
from ipaddress import ip_address
import whois


def clear():
	subprocess.call("clear" or "cls")

clear()

def port_scanner(host):
	clear()
	t1 = time()
	try:
		ip = socket.gethostbyname(host)
		print("-" * 50)
		print("Scanning : {}".format(ip))
		print("-" * 50)
		for port in range(1, 1025):
			sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
			connection = sock.connect_ex((ip,port))
			if connection == 0:
				print("\033[93mPort {} => open => {}".format(port,socket.getservbyport(port,"tcp" or "udp")))
			sock.close()
		t2 = time()
		print("\033[94m\nScanning completed in {} seconds".format(int(t2 - t1)))
	except KeyboardInterrupt:
		print("\033[91mYou pressed ctrl + C")
		sys.exit()
	
	except socket.gaierror:
		print("\033[91mHost is not available")
		
		
	except socket.error:
		print("\033[91mUnable to connect to server")
		sys.exit()
			
	
def validate(ip):
	try:
		format = ip_address(ip)
		print("\033[93mValid IP")
		print(format)
	except ValueError:
		print("\033[91mInvalid IP")


while(True):
	print("\033[94m\n1. Port Scanning\n2. IP validator\n3. Who is Lookup\n4. Exit")
	choice = input("\033[92m\nEnter your choice : ")
	if choice == '1':
		web = input("\033[94mEnter the website url: ")
		port_scanner(web)
		x = input("Press enter to continue....,")
		clear()
	elif choice == '2':
		ip = input("\033[94mEnter IP : ")
		clear()
		validate(ip)
		x = input("Press enter to continue....,")
		clear()
	elif choice == '3':
		url = input("\033[94mEnter url : ")
		try:
			print("ip : {}".format(socket.gethostbyname(url)))
			info = whois.whois(url)
			print(info)
		except Exception as a:
			print(a)
			print("\033[91mInvalid url...,")
		x = input("Press enter to continue....,")
		clear()
	elif choice == '4':
		sys.exit()
	else:
		print("\033[91mEnter correct choice.....")
		x = input("Press enter to continue....,")
		clear()

		
